#!/bin/bash
# Hyperion Installation Configuration
# Copy to hyperion.conf and customize before running install.sh
#
# Usage:
#   cp config/hyperion.conf.example config/hyperion.conf
#   # Edit hyperion.conf with your settings
#   ./install.sh

#===============================================================================
# User Settings
#===============================================================================

# System user that will run Hyperion services
# Defaults to current user if not specified
# Note: Uses whoami as fallback for non-interactive contexts (systemd, cron)
HYPERION_USER="${HYPERION_USER:-${USER:-$(whoami)}}"

# System group for Hyperion services
# Defaults to current user's primary group if not specified
HYPERION_GROUP="${HYPERION_GROUP:-${USER:-$(whoami)}}"

# User home directory
# Used as base path for other directories if not explicitly set
HYPERION_HOME="${HYPERION_HOME:-${HOME}}"

#===============================================================================
# Installation Paths
#===============================================================================

# Where Hyperion source code is installed
# This is the cloned repository location
HYPERION_INSTALL_DIR="${HYPERION_INSTALL_DIR:-${HYPERION_HOME}/hyperion}"

# Claude's working directory
# This is where Claude performs work and stores temporary files
HYPERION_WORKSPACE="${HYPERION_WORKSPACE:-${HYPERION_HOME}/hyperion-workspace}"

# Message queue directories
# Stores incoming/outgoing messages, audio files, and processed messages
HYPERION_MESSAGES="${HYPERION_MESSAGES:-${HYPERION_HOME}/messages}"

#===============================================================================
# Repository Settings (for forks)
#===============================================================================

# Git repository URL
# Change this if you're installing from a fork
HYPERION_REPO_URL="${HYPERION_REPO_URL:-https://github.com/SiderealPress/hyperion.git}"

# Branch to install from
# Useful for testing or installing from a specific version
HYPERION_BRANCH="${HYPERION_BRANCH:-main}"

#===============================================================================
# Private Configuration Overlay (Optional)
#===============================================================================

# Path to private configuration repository
# If set, install.sh will overlay files from this directory after installation
# This allows you to maintain custom configurations separately from the main repo
#
# Example structure for your private config repo:
#   ~/hyperion-config/
#   ├── config.env          # Your secrets (API keys, tokens)
#   ├── CLAUDE.md           # Custom Claude context
#   ├── agents/             # Custom agent definitions
#   ├── context/            # Personal context for brain dumps
#   │   ├── goals.md        # Long/short-term objectives
#   │   ├── projects.md     # Active projects
#   │   ├── values.md       # Core principles
#   │   ├── habits.md       # Routines and preferences
#   │   ├── people.md       # Key relationships
#   │   ├── desires.md      # Wants and aspirations
#   │   └── serendipity.md  # Random discoveries
#   └── hooks/              # Custom installation hooks
#
# IMPORTANT: Your config directory should have restricted permissions:
#   chmod 700 ~/hyperion-config
#   chmod 600 ~/hyperion-config/config.env
#
# HYPERION_CONFIG_DIR="${HYPERION_HOME}/hyperion-config"

#===============================================================================
# Feature Flags
#===============================================================================

# Enable scheduled tasks feature
# When true, the cron-based scheduled jobs system will be configured
HYPERION_ENABLE_SCHEDULED_TASKS="${HYPERION_ENABLE_SCHEDULED_TASKS:-true}"

# Enable voice message transcription
# When true, whisper.cpp will be installed for local audio transcription
# Note: Requires ~400MB disk space and build tools (make, cmake, gcc)
HYPERION_ENABLE_VOICE="${HYPERION_ENABLE_VOICE:-true}"

#===============================================================================
# Brain Dumps Feature
#===============================================================================
# The brain-dumps agent processes voice messages that appear to be unstructured
# thoughts, ideas, or stream-of-consciousness notes, saving them to GitHub Issues.
#
# The agent definition lives in .claude/agents/brain-dumps.md and can be
# customized via the private config overlay by placing your own version at:
#   ${HYPERION_CONFIG_DIR}/agents/brain-dumps.md
#
# See docs/BRAIN-DUMPS.md for full documentation.
#===============================================================================

# Enable brain dump processing for voice messages
# When true, voice messages detected as "brain dumps" (stream of consciousness,
# ideas, thoughts) will be automatically saved to a dedicated GitHub repository
# Set to false to disable the feature entirely
HYPERION_BRAIN_DUMPS_ENABLED="${HYPERION_BRAIN_DUMPS_ENABLED:-true}"

# Repository name for storing brain dumps
# Brain dumps are saved as GitHub issues in this repository
# The repository will be created as private if it doesn't exist
# Format: Just the repo name (not full path) - will be created under your GitHub username
HYPERION_BRAIN_DUMPS_REPO="${HYPERION_BRAIN_DUMPS_REPO:-brain-dumps}"

#===============================================================================
# Personal Context (for Brain Dumps)
#===============================================================================
# The context directory contains personal information about your goals, projects,
# people, values, etc. This enables intelligent context matching in brain dumps.
#
# Set up context by:
#   1. Creating context directory: mkdir -p ${HYPERION_CONFIG_DIR}/context
#   2. Copying templates: cp ~/hyperion/context-templates/*.md ${HYPERION_CONFIG_DIR}/context/
#   3. Editing files with your personal information
#
# See context-templates/README.md and docs/CUSTOMIZATION.md for details.
#===============================================================================

# Path to personal context files
# Contains markdown files: goals.md, projects.md, values.md, habits.md, people.md,
# desires.md, serendipity.md
# If not set, brain dumps will be processed without context matching
# HYPERION_CONTEXT_DIR="${HYPERION_CONFIG_DIR}/context"

#===============================================================================
# Slack Integration (Optional)
#===============================================================================
# Enable Slack as a message source alongside or instead of Telegram.
# Uses Socket Mode for simplicity (no public webhook URL required).
#
# Setup instructions:
#   1. Create a Slack app at https://api.slack.com/apps
#   2. Enable Socket Mode in your app settings
#   3. Add the following OAuth scopes under "OAuth & Permissions":
#      - app_mentions:read     (to receive @mentions)
#      - channels:history      (to read channel messages)
#      - channels:read         (to get channel info)
#      - chat:write            (to send messages)
#      - files:read            (to download shared files)
#      - groups:history        (for private channels)
#      - groups:read           (for private channel info)
#      - im:history            (for direct messages)
#      - im:read               (for DM info)
#      - reactions:write       (to add emoji reactions)
#      - users:read            (to get user info)
#   4. Subscribe to bot events under "Event Subscriptions":
#      - app_mention           (when someone @mentions the bot)
#      - message.channels      (messages in public channels)
#      - message.groups        (messages in private channels)
#      - message.im            (direct messages)
#   5. Install the app to your workspace
#   6. Copy the Bot User OAuth Token (starts with xoxb-)
#   7. Generate an App-Level Token with connections:write scope (starts with xapp-)
#
# See docs/SLACK-SETUP.md for detailed setup instructions.
#===============================================================================

# Enable the Slack router service
# When true, hyperion-slack-router.service will be enabled
# HYPERION_ENABLE_SLACK="${HYPERION_ENABLE_SLACK:-false}"

# Slack Bot User OAuth Token (starts with xoxb-)
# Get this from: Your App > OAuth & Permissions > Bot User OAuth Token
# HYPERION_SLACK_BOT_TOKEN=""

# Slack App-Level Token (starts with xapp-)
# Get this from: Your App > Basic Information > App-Level Tokens
# Must have connections:write scope for Socket Mode
# HYPERION_SLACK_APP_TOKEN=""

# Optional: Restrict to specific channels (comma-separated channel IDs)
# If empty, bot responds in all channels where it's invited
# Channel IDs look like: C01ABCDEF12
# HYPERION_SLACK_ALLOWED_CHANNELS=""

# Optional: Restrict to specific users (comma-separated user IDs)
# If empty, bot responds to all users
# User IDs look like: U01ABCDEF12
# HYPERION_SLACK_ALLOWED_USERS=""
